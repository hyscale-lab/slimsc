#!/bin/bash
#PBS -N sim_score_analysis
#PBS -l select=1:ngpus=1
#PBS -l walltime=4:30:00
#PBS -P personal-colinhon
#PBS -q normal
#PBS -j oe

# Set output directory name
OUTPUT_DIR="qwq_n8_aime_dissimilarity_test"

# Set PBS output file to match output directory
#PBS -o ${OUTPUT_DIR}.o%j

# Change to the working directory
cd ${HOME}/slimsc/prune/analysis

# Load conda environment
source ~/.bashrc
conda activate vllm

# Run the analysis script
python sim_score_analysis.py \
    --model_arch QwQ-32B \
    --base_slimsc_dir "${HOME}/slimsc" \
    --dataset_name aime \
    --control_run_name sc_8_control \
    --n_chains 8 \
    --tokenizer_path "${HOME}/scratch/qwq" \
    --num_questions 1 \
    --seed 7 \
    --token_step_size 100 \
    --output_dir ${OUTPUT_DIR} \
    --similarity_mode dissimilarity