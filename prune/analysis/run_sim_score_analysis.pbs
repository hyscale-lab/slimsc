#!/bin/bash
#PBS -N sim_score_analysis
#PBS -l select=1:ncpus=16:mem=110gb:ngpus=1
#PBS -l walltime=14:30:00
#PBS -P personal-chiraag0
#PBS -q normal
#PBS -j oe
#PBS -k o

# Set output directory name
OUTPUT_DIR="gpqa_n64_s2"

# Set PBS output file to match output directory
#PBS -o ${OUTPUT_DIR}.o%j

# Change to the working directory
cd /home/users/ntu/chiraag0/slimsc/prune/analysis

# Load conda environment
source ~/.bashrc
conda activate vllm

# Run the analysis script
python -u sim_score_analysis.py \
    --model_arch R1-Combined \
    --base_slimsc_dir "/home/users/ntu/chiraag0/slimsc" \
    --dataset_name gpqa_diamond \
    --control_run_name sc_64_control \
    --n_chains 64 \
    --tokenizer_path /home/users/ntu/chiraag0/scratch/r1-distill \
    --num_questions 2 \
    --seed 7 \
    --token_step_size 100 \
    --output_dir ${OUTPUT_DIR} 