Okay, so I have this problem here: Let ω ≠ 1 be a 13th root of unity. I need to find the remainder when the product from k=0 to 12 of (2 - 2ω^k + ω^{2k}) is divided by 1000. Hmm, that sounds a bit intimidating at first, but maybe I can break it down.

First, I remember that roots of unity have some nice properties, especially when dealing with products and cyclotomic polynomials. Since ω is a 13th root of unity, it satisfies ω^13 = 1, and the minimal polynomial over the integers is the 13th cyclotomic polynomial. But I'm not sure yet how that connects here.

The product given is over all k from 0 to 12 of (2 - 2ω^k + ω^{2k}). Let me see if I can rewrite each term to make it more manageable. Let's look at the term inside the product:

2 - 2ω^k + ω^{2k}

Hmm, maybe factor out a 2? Wait, but the terms

---------------

 have different powers. Alternatively, maybe notice that ω^{2k} is (ω^k)^2. Let me set z = ω^k for each term. Then each term becomes 2 - 2z + z². So the product becomes the product over all z (since ω^k runs through all 13th roots of unity except 1, but wait, actually when k=0, ω^0 = 1, so z would be 1 as well. Wait, but the problem states ω ≠ 1, but the product is over k from 0 to 12, so that

---------------

 includes ω^0=1. Maybe the problem just specifies ω is a primitive root? Not sure. Anyway, perhaps the key is that the product is over all 13th roots of unity, since ω is a primitive 13th root, then ω^k for k=0 to 12 gives all the roots. So maybe the product is over all 13th roots of unity z of (2 - 2z + z²). But let

---------------

 me confirm that.

Wait, the problem says "Let ω ≠ 1 be a 13th root of unity", but then the product is over k=0 to 12 of (2 - 2ω^k + ω^{2k}). Since ω is a primitive 13th root, then ω^k for k=0,...,12 are all distinct roots of unity. So the product is indeed over all 13th roots of unity (including 1). So maybe the problem just says ω ≠1 to clarify that it's a primitive root? Not sure, but maybe that's just part of the problem statement.

So, proceeding

---------------

, the product is over all 13th roots of unity z of (2 - 2z + z²). Let me denote this product as P. So P = product_{z^{13}=1} (2 - 2z + z²). Maybe

---------------

 I can relate this product to some known polynomial evaluated at certain points?

I recall that products over roots of unity can sometimes be expressed using cyclotomic polynomials. The cyclotomic polynomial Φ_n(x) is the minimal polynomial whose roots are the primitive nth roots of unity. Since we're dealing with all 13th roots of unity, and 13 is prime, all roots except 1 are primitive. So Φ_13(x) is the minimal polynomial for primitive 13th roots, and it has degree 12. But our product is over all 13 roots, so maybe I need to consider (x^13 -1) which factors into (x -1)Φ_13(x).

Alternatively, perhaps the

---------------

 product P can be related to evaluating some polynomial at x=2 or something like that. Let me think. Let me consider that if I have a polynomial whose roots are the 13th roots of unity, which is x^13 - 1. So if I can write the product as something involving evaluating a polynomial at specific points.

Alternatively, note

---------------

 that each term in the product is 2 - 2z + z². Let me rearrange that: z² - 2z + 2. So each term is z² - 2z + 2. Wait, so P is the product over all 13th roots of unity z of (z² - 2z + 2).

Hmm, so maybe I can write this as the product over z of (z² - 2z + 2). To compute this product, perhaps consider that if I have a polynomial Q(z) such that Q(z) = z^13 -1, then the product over all roots z of Q(z) of some function f(z) can be related to the resultant or something else. Alternatively, maybe consider that the product over (z - a_i) is the polynomial, so perhaps manipulate the terms into a form that can be expressed as another polynomial evaluated at specific points.

Alternatively, perhaps

---------------

 factor the quadratic term. Let me see: z² - 2z + 2 can be written as (z - (1 + i))(z - (1 - i)), since the roots are 1 ± i. So then the product over all z^{13}=1 of (z - (1 + i))(z - (1 - i)). So that would be the product over all 13th roots of unity of (z - (1 + i)) multiplied by the product over all 13th roots of unity of (z - (1 - i)). 

Therefore, P = [Product_{z^{13}=1} (z - (1 + i))] × [Product_{z^{13}=1} (z - (1 - i))].

But the product over all z^{13}=1 of (z - a) is just the value of the polynomial x^13 - 1 evaluated at a, right? Because if you have a polynomial f(z) = Product_{roots z_j} (z - z_j), then f(a) = Product_{z_j} (a - z_j). Wait, actually, if f(z) = z^13 -1, then f(a) = a^13 -1 = Product_{z^{13}=1} (a - z). Therefore, the product over z^{13}=1 of (z - a) would be (-1)^13 times the product over (a - z), so that would be - (a^13 -1). Wait, let me check:

Let me consider

---------------

 f(z) = z^13 -1. Then f(a) = Product_{z^{13}=1} (a - z). Therefore, the product over (a - z) is a^13 -1, so the product over (z - a) would be (-1)^{13} Product_{z} (a - z) = - (a^13 -1). Since 13 is odd, (-1)^13 = -1. Therefore,

Product_{z^{13}=1} (z - a) = - (a^13 -1). 

Therefore, in

---------------

 our case, the first product (over z of (z - (1 + i))) is equal to -[(1 + i)^13 -1], and similarly the second product (over z of (z - (1 - i))) is equal to -[(1 - i)^13 -1]. 

Therefore, P = [ - ( (1 + i)^13 -1 ) ] × [ - ( (1 - i)^13 -1 ) ] = [ ( (1 + i)^13 -1 ) ( (1 - i)^13 -1 ) ] multiplied by (-1)^2 = 1. So P = [ ( (1 + i)^13 -1 )( (1 - i)^13 -1 ) ].

Hmm, so now I need to compute (1 + i)^13 and (1 - i)^13, subtract 1 from each, multiply them together, and then take the product. Let me compute (1 + i)^n first. Since 1 + i is a complex number, perhaps using polar form would help here. 

The modulus of 1 + i is sqrt(1^2 + 1^2) = sqrt(2), and its angle (argument) is π/4 radians. Therefore, (1 + i)^13 = [sqrt(2)]^13 * e^{i * 13*(π/4)}. Let me compute that:

First, [sqrt(2)]^13 = (2^{1/2})^13 = 2^{13/2} = 2^6 * 2^{1/2} = 64 * sqrt(2).

The angle is 13*(π/4). Let me compute 13*(π/4) modulo 2π. 13 divided by 8 (since 2π/(π/4)=8) gives 13 mod 8 = 5, so 5*(π/4). So angle is 5π/4. Therefore, e^{i*5π/4} = cos(5π/4) + i sin(5π/4) = -sqrt(2)/2 - i sqrt(2)/2. 

Thus, (1 + i)^13 = 64*sqrt(2) * [ -sqrt(2)/2 - i sqrt(2)/2 ] 

Let me compute this step by step. First, multiply 64*sqrt(2) with each term inside the brackets:

First term: 64*sqrt(2) * (-sqrt(2)/2) = 64 * (- (sqrt(2)*sqrt(2))/2 ) = 64*(-2/2) = 64*(-1) = -64

Second term: 64*sqrt(2) * (-i sqrt(2)/2) = same as above but times i, so -64i.

Therefore, (1 + i)^13 = -64 -64i. 

Similarly, let's compute (1 - i)^13. 

First, the modulus is also sqrt(2), and the angle is -π/4 (since 1 - i is in the fourth quadrant). So (1 - i)^13 = [sqrt(2)]^13 * e^{i*(-13π/4)}. 

Again, angle: -13π/4. Let's compute this modulo 2π. Adding 4π (since 2π is 8π/4) to -13π/4 gives (-13π/4 + 8π/4) = (-5π/4). Alternatively, -13π/4 is equivalent to -13π/4 + 4π = (-13π +16π)/4 = 3π/4? Wait, perhaps better to compute as

---------------

 follows: 

The angle -13π/4 can be expressed as adding multiples of 2π until it's within 0 to 2π. Let me add 4π (which is 16π/4):

-13π/4 + 16π/4 = 3π/4. So the angle is 3π/4. Wait, but the

---------------

 direction is different. Wait, actually, the angle for (1 - i) is -π/4, so raising it to the 13th power gives angle 13*(-π/4) = -13π/4. To get this in terms of positive angle, add 4π (since 4π = 16π/4):

-13π/4 + 16π/4 = 3π/4. Therefore, the angle is 3π/4. Wait, but 3π/4 is in the second quadrant. But

---------------

 (1 - i)^13, since the original angle is -π/4, after 13 times, the

---------------

 angle is -13π/4, which is equivalent to 3π/4 (since adding 4π gives 3π/4). Therefore, the direction is 3π/4, so the complex number is cos(3π/4) + i sin(3π/4) = -sqrt(2)/2 + i sqrt(2)/2.

Therefore, (1 - i)^13 = 64*sqrt(2) * [ -sqrt(2)/2 + i sqrt(2)/2 ]

Again, compute each term:

First term: 64*sqrt(2)*(-sqrt(2)/2) = same as before, -64

Second term: 64*sqrt(2)*(i sqrt(2)/2) = 64i

Therefore, (1 - i)^13 = -64 + 64i

So now, going back to the expression for P:

P = [ ( (1 + i)^13 -1 ) * ( (1 - i)^13 -1 ) ]

First compute each term inside the brackets:

(1 + i)^13 -1 = (-64 -64i) -1 = -65 -64i

(1 - i)^13 -1 = (-64 +64i) -1 = -65 +64i

Multiply these two complex numbers:

(-65 -64i)(-65 +64i) 

This is of the form (a - b)(a + b) where a = -65, b =64i? Wait, no, actually, it's ( -65 -64i )*( -65 +64i )

Let me compute it as:

Let me denote (a + b)(a - b) where a = -65, b =64i? Wait, no, actually, (

---------------

x + y)(x - y) is x² - y², but here the terms are different. Let me see:

Let me compute the

---------------

 product step by step:

First, multiply the first terms: (-65)(-65) = 4225

Then, outer: (-65)(64i) = -4160i

Inner: (-64i)(-65) = +4160i

Last: (-64i)(64i) = -4096 i² = -4096*(-1) = +4096

So adding all terms:

4225 -4160i +4160i +4096

The -4160i and +4160i cancel out, leaving 4225 + 4096 = 8321

Therefore, the product is 8321. So P = 8321.

Wait, hold on. Wait, but let

---------------

 me confirm that again:

Wait, the first term: (-65 -64i)(-65 +64i). Let me use

---------------

 the formula (a + b)(a - b) where a = -65, and b =64i. Wait, no: actually, the terms are ( -65 -64i ) and ( -65 +64i ), so if

---------------

 I factor out the negative sign from the first term's second part, it would be:

Let me write it as [ -65 -64i ][ -65 +64i ] = [ (-65) + (-64i) ] [ (-65) + 64i ]

Let me set a = -65, b =64i. Then it's (a + b)(a - b) where the second term is (a - (-b))? Wait, perhaps better to see

---------------

:

Let me think of it as ( (-65) + (-64i) )*( (-65) + 64i )

Which

---------------

 is of the form (c + d)(c - d) where c = -65 and d =64i. Wait, no, actually:

Wait, (a + b)(a - b) = a² - b². So here, if we have ( (-65) + (-64i) )*( (-65) +64i ), then it

---------------

's ( (-65) + (-64i) )*( (-65) - (-64i) )? Wait, no, not

---------------

 exactly. Let me re-express:

Wait, let me set x = -65 and y =64i. Then the first term is x - y and the second term is x + y. Wait, no:

Wait, first term: (-65 -64i) = x - y where x = -65 and y =64i? Wait, no, x

---------------

 - y would be (-65) - (64i). The second term is (-65 +64i) = x + y? Wait, x = -65, y =64i. Then x + y = (-65) +64i, and x - y = (-65) -64i. So yes, the product is (x - y)(x + y) = x² - y².

Therefore, indeed

---------------

, (-65)^2 - (64i)^2.

Compute that:

(-65)^2 = 4225

(64i)^2 = 64² * i² = 4096*(-1) = -4096

Therefore, the product is 4225 - (-4096) = 4225 + 4096 = 8321. Exactly as before. So that's correct.

Therefore, P = 8321. Wait, so the product is 8321. Then the problem says to find the remainder when this is divided by 1000. So 8321 divided by 1000. The remainder is the last three digits. 8321 divided by 1000 is 8 with a remainder of 321. So 8321 mod 1000 is 321. Therefore, the answer is 321?

Wait, but hold on a second. Let me confirm again.

---------------

 Wait, the product P is equal to 8321? Let me recap all steps to be sure.

First, each term in the product over 13th roots of unity of (z² -2z +2). Then, fact

---------------

oring each quadratic as (z - (1+i))(z - (1 -i)), so the product becomes [Product_z (z - (1+i))] times [Product_z (z - (1 -i))]. Then each product over z^{13}=1 of (z - a) is equal to - (a^13 -1). Therefore:

Product_z (z - (1+i)) = - [ (1 +i)^13 -1 ]

Product_z (z - (1 -i)) = - [ (1 -i)^13 -1 ]

Thus, multiplying them gives [ - ( (1 +i)^13 -1 ) ] * [ - ( (1 -i)^13 -1 ) ] = [ (1 +i)^13 -1 ] * [ (1 -i)^13 -1 ]

Then, computing (1 +i)^13 and (1 -i)^13:



---------------

We found (1 +i)^13 = -64 -64i and (1 -i)^13 = -64 +64i. Then subtract 1 from each:

(1 +i)^13 -1 = -65 -64i

(1 -i)^13 -1 = -65 +64i

Multiplying these gives ( -65 -64i )( -65 +64i ) = 8321. So yes, that's correct.

Therefore, the product P is indeed 8321. Then, 8321 mod 1000 is 321. Therefore, the remainder is 321.

But wait a second, let me think again. The problem states "the remainder when [...] is divided by 1000". So 8321 divided by 1000 is 8*1000=8000, so 8321-8000=321. So yes, 321 is correct.

But hold on, I

---------------

 feel like maybe I missed a negative sign somewhere? Let me check the step where I computed the product over (z - a). The formula was Product_{z^{13}=1} (z - a) = - (a^{13} -1 ). Therefore, if

---------------

 I have Product (z - a) = - (a^13 -1 ). Therefore, substituting a =1 +i and a=1 -i, so each

---------------

 product term is - ( (1 +i)^13 -1 ) and - ( (1 -i)^13 -1 ), so when multiplied together, gives [ - ( (1 +i)^13 -1 ) ] * [ - ( (1 -i)^13 -1 ) ] = [ ( (1 +i)^13 -1 ) * ( (1 -i)^13 -1 ) ]

Wait, so that is correct. So no negative sign left. So that term

---------------

 is positive 8321. Therefore, the answer is 8321 mod 1000 = 321.

Hmm, but let me check

---------------

 with an alternative approach to confirm. Let me see if there's another way to compute the product. 

Alternatively, perhaps notice that z^13 =1, so for each term in the product, we can write z² -2z +2. Let me see if I can write this in terms of z^13. Maybe

---------------

 manipulate the expression:

Note that z^13 =1, so z^{-1} = z^{12}, etc. Not sure.

Alternatively, consider that the product over all z^{13}=1 of (z² -2z +2). Let me consider that the product is equal to the product over all z (z² - 2z + 2). Let me think of this as evaluating a certain polynomial at specific points. 

Suppose we consider the polynomial f(x) = Product_{z^{13}=1} (x - z). Then f(x) = x^13 -1. But how does that help?

Alternatively, perhaps think of the product as the resultant of some polynomials? Not sure. Alternatively, perhaps

---------------

 consider logarithms? Probably not.

Alternatively, perhaps consider that the product over all roots z of (z² - 2 z + 2) is equal to the product over all roots of (z - α)(z - β), where α and β are roots of the quadratic equation x² -2x +2 =0. The roots are 1 ±i as before. So the product over all z^{13}=1 of (z - α)(z - β) is equal to [Product_z (z - α)] × [Product_z (z - β)] which is exactly what I did before. So that's consistent.

Therefore, that approach is correct, and the result is 8321. So mod 1000 is 321. Hmm, so unless

---------------

 I made a mistake in calculating (1 +i)^13?

Let me recompute (1 +i)^13:

We know that (1 + i)^2 = 2i. So (1 +i)^2 = 2i. Then (1 +i)^4 = (2i)^2 = -4. (1 +i)^8 = (-4)^2 =16. Then (1 +i)^12 = (1 +i)^8 * (1 +i)^4 = 16*(-4) = -64. Then (1 +i)^13 = (1 +i)^12 * (1 +i) = (-64)*(1 +i) = -64 -64i. Yes, that matches. Similarly, (1 -i)^2 = (1 - 2i + i²) = 1 -2i -1 = -2i. Then (1 -i)^4 = (-2i)^2 = -4. (1 -i)^8 = (-4)^2 =16. (1 -i)^12 = (1 -i)^8*(1 -i)^4 =16*(-4) = -64. Then (1 -i)^13 = (1 -i)^12*(1 -i) = -64*(1 -i) = -64 +64i. That also checks out.

Therefore, all steps are correct, so 8321 mod 1000 is indeed 321. Therefore, the answer should be 321.

Wait, but just to be thorough, let me check if the problem says

---------------

 "the product from k=0 to 12", which includes k=0, so when k=0, ω^0 =1, so the term is 2 -2*1 +1²= 2-2+1=1. So the first term is 1. Then the rest of the terms (

---------------

from k=1 to 12) would be multiplied. But in my calculation above, I considered all 13th roots of unity, so that's correct. However

---------------

, let me see if the product over all z^{13}=1 of (z² -2z +2) is indeed 8321. Let me test with a simpler case. Let me try with a smaller n, say n=1, but 13 is prime. Maybe n=3? Let's see if the method works for n=3.

Suppose n=3, and compute product_{k=0}^2 (2 -2ω^k + ω^{2k}) where ω is a primitive 3rd root of unity.

First, let's compute each term:

For k=0: 2 -2*1 +1² =1 as before.

For k=1: 2 -2ω + ω². Since ω^3=1, ω² = ω^{-1}

Similarly, for k=2: 2 -2ω² + ω^4 = 2 -2ω² + ω (since ω^4=ω)

So the product is (1)*(2 -2ω + ω²)*(2 -2ω² + ω)

Let me compute this.

Alternatively, using the same method as above: the product over all z^3=1 of (z² -2z +2). The roots are 1, ω, ω².

Compute Product

---------------

_{z^3=1} (z² -2z +2) = (1 -2 +2)*(ω² -2ω +2)*(ω^4 -2ω² +2). Wait, but that's similar

---------------

 to above.

Alternatively, using the formula: Product_{z^3=1} (z - a) = - (a^3 -1). So the

---------------

 product over (z^2 -2z +2) would be the same as before? Wait, no, same approach:

Factor z² -2z +2 into (z - (1+i))(z - (1 -i)), so the product over z^3=1 is [Product (z - (1+i))][Product (z - (1 -i))] = [ - ( (1 +i)^3 -1 ) ] * [ - ( (1 -i)^3 -1 ) ]

Compute (1 +i)^3: (1+i)^3 = 1 + 3i + 3i² + i^3 = 1 +3i -3 -i = (-2 +2i). Similarly (1 -i)^3 = 1 -3i +3i² -i^3 =1 -3i -3 +i = (-2 -2i).

Then (1 +i)^3 -1 = (-2 +2i) -1 = -3 +2i. Similarly (1 -i)^3 -1 = -3 -2i. Then the product becomes [ -(-3 +2i) ] * [ -(-3 -2i) ] = [3 -2i] * [3 +2i] = 9 +4 =13. 

Therefore, the product over all z^3=1 of (z² -2z +2) is 13. Let me compute directly:

Compute each term:

At z=1: (1 -2 +2)=1.

At z=ω: (ω² -2ω +2). Let me compute for ω = e^(2πi/3) = -1/2 +i√3/2. Then ω² = e^(4πi/3) = -1/2 -i√3/2.

So ω² -2ω +2 = [ -1/2 -i√3/2 ] -2[ -1/2 +i√3/2 ] +2 

= -1/2 -i√3/2 +1 -i√3 +2 

= ( -1/2 +1 +2 ) + ( -i√3/2 -i√3 )

= ( 5/2 ) + ( - (3i√3)/2 )

Wait, that's complex. Hmm, but when multiplied by the term at z=ω², which would be similar but conjugated, perhaps the product becomes real?

Wait, let me compute the product (ω² -2ω +2)(ω -2ω² +2). Let me compute each

---------------

 term:

First term: (ω² -2ω +2)(ω -2ω² +2)

Let me expand this:

Multiply term by term:

First ω² * ω = ω^3 =1

ω²*(-2ω²) = -2ω^4 = -2ω (since ω^3=1, so ω^4=ω)

ω²*2 = 2ω²

-2ω * ω = -2ω²

-2ω*(-2ω²) = +4ω^3 =4*1=4

-2ω*2 = -4ω

+2*ω = 2ω

+2*(-2ω²) = -4ω²

+2*2 =4

Now, let's collect all terms:

1 (from first term)

-2ω (from second term)

+2ω² (from third term)

-2ω² (from fourth term)

+4 (from fifth term)

-4ω (from sixth term)

+2ω (from seventh term)

-4ω² (from eighth term)

+4 (from ninth term)

Now combine like terms:

Constants: 1 +4 +4 =9

Terms with ω: -2ω -4ω +2ω = (-2 -4 +2)ω = -4ω

Terms with ω²: 2ω² -2ω² -4ω² = (2 -2 -4)ω² = -4ω²

So total expression is 9 -4ω -4ω²

But since ω + ω² = -1 (because 1 + ω + ω² =0 for 3rd roots), so -4(ω + ω²) = -4*(-1)=4. Therefore, the total is 9 +4 =13. So that matches the previous result. Therefore, the method works here. Thus, my

---------------

 approach for the original problem is valid. So 8321 mod 1000 is indeed 321. 

Therefore, I think the answer is 321. 

Wait, but just to make sure, perhaps I miscalculated 8321 mod 1000. Let me do that again. 1000*8=8000, 8321-8000=321. So yes, that's correct. So I think the final answer is 321.

**Final Answer**
\boxed{321}


Given \(\omega \neq 1\) is a 13th root of unity, we need to find the remainder when the product \(\prod_{k=0}^{12}(2 - 2\omega^k + \omega^{2k})\) is divided by 1000.

First, we recognize that the product is over all 13th roots of unity \(z\) (since \(\omega^k\) for \(k = 0, 1, \ldots, 12\) gives all 13th roots of unity). We rewrite each term \(2 - 2z + z^2\) as \(z^2 - 2z + 2\). Thus, the product becomes:

\[
\prod_{z^{13}=1} (z^2 - 2z + 2)
\]

We factor each quadratic term \(z^2 - 2z + 2\) as \((z - (1 + i))(z - (1 - i))\). Therefore, the product can be split into two products:

\[
\left( \prod_{z^{13}=1} (z - (1 + i)) \right) \left( \prod_{z^{13}=1} (z - (1 - i)) \right)
\]

Using the polynomial \(z^{13} - 1\), which has roots at all 13th roots of unity, we know that for any complex number \(a\):

\[
\prod_{z^{13}=1} (z - a) = - (a^{13} - 1)
\]

Applying this to \(a = 1 + i\) and \(a = 1 - i\):

\[
\prod_{z^{13}=1} (z - (1 + i)) = - \left( (1 + i)^{13} - 1 \right)
\]
\[
\prod_{z^{13}=1} (z - (1 - i)) = - \left( (1 - i)^{13} - 1 \right)
\]

Calculating \((1 + i)^{13}\) and \((1 - i)^{13}\):

- The modulus of \(1 + i\) is \(\sqrt{2}\), and its argument is \(\pi/4\). Raising to the 13th power:
  \[
  (1 + i)^{13} = (\sqrt{2})^{13} \left( \cos \frac{13\pi}{4} + i \sin \frac{13\pi}{4} \right) = -64 - 64i
  \]
- Similarly, for \(1 - i\) with argument \(-\pi/4\):
  \[
  (1 - i)^{13} = (\sqrt{2})^{13} \left( \cos \left( -\frac{13\pi}{4} \right) + i \sin \left( -\frac{13\pi}{4} \right) \right) = -64 + 64i
  \]

Substituting these into the products:

\[
- \left( (1 + i)^{13} - 1 \right) = -(-64 - 64i - 1) = -(-65 - 64i) = 65 + 64i
\]
\[
- \left( (1 - i)^{13} - 1 \right) = -(-64 + 64i - 1) = -(-65 + 64i) = 65 - 64i
\]

Multiplying these results:

\[
(65 + 64i)(65 - 64i) = 65^2 - (64i)^2 = 4225 - (-4096) = 4225 + 4096 = 8321
\]

Finally, finding the remainder of 8321 when divided by 1000:

\[
8321 \mod 1000 = 321
\]

Thus, the remainder when the product is divided by 1000 is \(\boxed{321}\).<|im_end|>